# CPR 語音引導計時器 v2.1

基於 2025 AHA ACLS 指引的心肺復甦語音引導計時器。

## v2.1 更新 (2025-12-20)

### 重大改進

| 更新項目 | 說明 |
|---------|------|
| **動態 Epi 邏輯** | 不再固定時間提示，改為根據上次給藥時間動態計算 |
| **iPad 橫向佈局** | CSS Grid 雙欄設計，單頁呈現無需捲動 |
| **倒數計時器** | 主顯示改為循環倒數 (02:00 → 00:00) |
| **快進按鈕** | 測試用 +1:00 快進功能 |

### Epinephrine 給藥邏輯 (v2.1)

```
首次 Epi：第一次心律檢查時 (2:00) 提示
後續 Epi：距上次給藥 ≥3 分鐘，於下一次心律檢查時提示
（配合 2 分鐘循環，實際間隔為 4 分鐘）
```

## v2.0 功能

### 依據醫材原型品構想書優化

| 構想書規格 | 實作狀態 |
|-----------|---------|
| 全螢幕閃爍警示 | ✅ 紅色閃爍覆蓋層 |
| 警示解除按鈕 | ✅ 需手動確認才能解除 |
| 換手壓胸提醒 | ✅ 每次心律檢查時提示 |
| 壓胸者編號追蹤 | ✅ 自動遞增記錄 |
| ROSC 記錄 | ✅ 新增 ROSC 按鈕 |
| 音量控制 | ✅ 可調整語音/節拍音量 |
| 全螢幕模式 | ✅ 一鍵進入全螢幕 |
| Epi 倒數提醒 | ✅ 動態計算下次時間 |
| 螢幕常亮 | ✅ Wake Lock API |

## 功能特色

- **自動計時**：追蹤總急救時間與 2 分鐘循環倒數
- **動態 Epi 提示**：根據上次給藥時間自動計算下次提示
- **語音提示**：在關鍵時間點播放婷婷語音提示
- **全螢幕警示**：重要事件時全螢幕紅色閃爍，需手動確認
- **心律選擇**：支援可電擊心律 (VF/pVT) 與不可電擊心律 (PEA/Asystole)
- **壓胸節拍器**：110 BPM 節拍器，符合 AHA 建議
- **換手追蹤**：自動記錄壓胸者輪換
- **事件記錄**：記錄電擊、Epinephrine、ROSC 時間
- **iPad 優化**：橫向雙欄佈局，適合平板操作

## 使用方式

1. 直接開啟 `index.html` 即可使用
2. 或使用本地伺服器：
   ```bash
   cd cpr_timer_app
   python3 -m http.server 8080
   # 然後開啟 http://localhost:8080
   ```

## 鍵盤快捷鍵

| 按鍵 | 功能 |
|------|------|
| `空白鍵` / `Enter` | 開始/暫停計時（或解除警示） |
| `S` | 記錄電擊 |
| `E` | 記錄 Epinephrine |
| `M` | 開關節拍器 |
| `R` | 記錄 ROSC |
| `F` | 全螢幕 |
| `Ctrl+R` | 重置 |

## 語音提示邏輯

### 固定時間提示

| 時間 | 提示內容 | 全螢幕警示 |
|------|---------|-----------|
| 00:00 | 急救開始！計時啟動，請確認角色 | - |
| 01:55 | 準備停止，準備心律檢查 | - |
| 02:00 | 停止壓胸！確認心律！ | ✅ |
| 10:00 | CPR 進入第十分鐘 | ✅ |
| 20:00 | CPR 進入第二十分鐘 | ✅ |
| 30:00 | CPR 進入第三十分鐘 | ✅ |

### 動態提示 (v2.1)

| 條件 | 提示內容 |
|------|---------|
| 每 2 分鐘循環結束 | 停止壓胸、確認心律、換手壓胸 |
| 首次 Epi (≥2:00 且未給過) | 💉 Epinephrine 1mg IV |
| 後續 Epi (距上次 ≥3 min) | 💉 Epinephrine 1mg IV |
| 可電擊心律 | 考慮電擊 |

## 設定選項

| 設定 | 說明 | 預設 |
|------|------|------|
| 語音提示 | 播放婷婷語音 | 開啟 |
| 視覺警示 | 全螢幕閃爍 | 開啟 |
| 預警提示 | 5秒前預警 | 開啟 |
| 手動確認警示 | 警示需點擊解除 | 開啟 |
| 音量 | 語音/節拍音量 | 80% |

## 專利資訊

- 新型專利：M646682（急救輔助裝置）
- 發明專利：I844435（救護提示輔助系統）

## 2025 AHA ACLS 指引重點

- **CPR 循環**：每 2 分鐘檢查心律、換手壓胸
- **Epinephrine**：1mg IV，每 3-5 分鐘
- **可電擊心律**：先電擊，再給 Epinephrine
- **不可電擊心律**：盡早給 Epinephrine
- **高品質 CPR**：
  - 壓胸深度 ≥ 5 cm
  - 壓胸速率 100-120 次/分鐘
  - 完全回彈
  - 最小化中斷

## 參考資料

- [2025 AHA ACLS Guidelines](https://www.ahajournals.org/doi/10.1161/CIR.0000000000001376)
- 醫材原型品構想書 v3

## 注意事項

本工具僅供訓練與研究用途，實際臨床急救請依據現場情況與專業判斷。
